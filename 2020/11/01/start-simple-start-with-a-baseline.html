<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Start simple, start with a baseline ! | Yet another blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Start simple, start with a baseline !" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Graduate student in computer science, blog about my learning journey (AI/ Deep learning/ Machine learning/ Computer vision)." />
<meta property="og:description" content="Graduate student in computer science, blog about my learning journey (AI/ Deep learning/ Machine learning/ Computer vision)." />
<link rel="canonical" href="https://igrek-code.github.io/blog/2020/11/01/start-simple-start-with-a-baseline.html" />
<meta property="og:url" content="https://igrek-code.github.io/blog/2020/11/01/start-simple-start-with-a-baseline.html" />
<meta property="og:site_name" content="Yet another blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-01T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://igrek-code.github.io/blog/2020/11/01/start-simple-start-with-a-baseline.html","@type":"BlogPosting","headline":"Start simple, start with a baseline !","dateModified":"2020-11-01T00:00:00-05:00","datePublished":"2020-11-01T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://igrek-code.github.io/blog/2020/11/01/start-simple-start-with-a-baseline.html"},"description":"Graduate student in computer science, blog about my learning journey (AI/ Deep learning/ Machine learning/ Computer vision).","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://igrek-code.github.io/blog/feed.xml" title="Yet another blog" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Yet another blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Start simple, start with a baseline !</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-01T00:00:00-05:00" itemprop="datePublished">
        Nov 1, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/igrek-code/blog/tree/master/_notebooks/2020-11-01-start-simple-start-with-a-baseline.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          <div class="px-2">
    <a href="https://colab.research.google.com/github/igrek-code/blog/blob/master/_notebooks/2020-11-01-start-simple-start-with-a-baseline.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Motivation">Motivation </a></li>
<li class="toc-entry toc-h2"><a href="#What-will-we-do-?">What will we do ? </a></li>
<li class="toc-entry toc-h2"><a href="#How-will-we-do-it-?">How will we do it ? </a></li>
<li class="toc-entry toc-h2"><a href="#Let's-do-it-!">Let&#39;s do it ! </a>
<ul>
<li class="toc-entry toc-h3"><a href="#1.-Create-our-perfect-3-and-7">1. Create our perfect 3 and 7 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Images-are-numbers-?">Images are numbers ? </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#2.-Measure-the-distance-(similarity)">2. Measure the distance (similarity) </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-01-start-simple-start-with-a-baseline.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Motivation">
<a class="anchor" href="#Motivation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation<a class="anchor-link" href="#Motivation"> </a>
</h2>
<p>Don't start with something fancy, complicated as your first solution.<br>
Always start with a baseline (simple solution). Why ? You might ask, well there's two reasons for that :</p>
<ul>
<li>So you have something to compare to.</li>
<li>Because complicated does not imply effective (your simple solution might be better then the fancy one).  </li>
</ul>
<blockquote>
<p>If you are using colab, make sure to change your runtime to GPU.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What-will-we-do-?">
<a class="anchor" href="#What-will-we-do-?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What will we do ?<a class="anchor-link" href="#What-will-we-do-?"> </a>
</h2>
<p>We will to implement a simple approach to handwritten digit classification <strong>without Deep Learning</strong>. We'll see that it is pretty accurate, and we'll learn some fastai, pytorch, computer vision basics along the way.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-will-we-do-it-?">
<a class="anchor" href="#How-will-we-do-it-?" aria-hidden="true"><span class="octicon octicon-link"></span></a>How will we do it ?<a class="anchor-link" href="#How-will-we-do-it-?"> </a>
</h2>
<p>We will use a dataset called <strong>MNIST</strong>, which is a pretty popular dataset containing images of handwritten digits but we'll use a sample of it containing only the digits 3 and 7 (which is provided by fastai).</p>
<p>Our approach consists of two steps:</p>
<ul>
<li>Obtain the image of perfect 3 and 7.</li>
<li>Compare every picture we have to these perfect 3 and 7, and to whom ever it is closest, we'll attribute it the corresponding label.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Let's-do-it-!">
<a class="anchor" href="#Let's-do-it-!" aria-hidden="true"><span class="octicon octicon-link"></span></a>Let's do it !<a class="anchor-link" href="#Let's-do-it-!"> </a>
</h2>
<h3 id="1.-Create-our-perfect-3-and-7">
<a class="anchor" href="#1.-Create-our-perfect-3-and-7" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Create our perfect 3 and 7<a class="anchor-link" href="#1.-Create-our-perfect-3-and-7"> </a>
</h3>
<p>Okay, before we start let's download our dataset. For that we will use the fastai method <em>untar_data</em>, which given an <em>url</em>, downloads the dataset (if not already downloaded), and extracts it (if not already exctracted).<br>
We position our selves in the dataset folder by setting the <em>BASE_PATH</em>, to the path returned by the method.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">)</span>
<span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inside that folder we can see two other folders <em>valid</em> and <em>train</em>, that contain the validation and training set respectively. You'll see this pretty frequently when you download publically availble datasets (they will be already be split into a <em>valid</em> and <em>training</em> sets for you).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [Path('labels.csv'),Path('valid'),Path('train')]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now inside the train folder, we have also two other folders 3 and 7 that as you probably guess it contain the respective images of the digits (This is also pretty common in public datasets, the different images will be put in folders named with the corresponding label).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'train'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [Path('train/3'),Path('train/7')]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We get the paths of the different images (sorted), to open them for later. If you notice, there is <em>(#6131)</em> before the list, this is because it's not an actual list but rather a fastai object called L, which is a list but with some additional features (another feature is that it displays only the first ten elements of the list).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">threes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'train'</span><span class="o">/</span><span class="s1">'3'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">sevens</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'train'</span><span class="o">/</span><span class="s1">'7'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">threes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#6131) [Path('train/3/10.png'),Path('train/3/10000.png'),Path('train/3/10011.png'),Path('train/3/10031.png'),Path('train/3/10034.png'),Path('train/3/10042.png'),Path('train/3/10052.png'),Path('train/3/1007.png'),Path('train/3/10074.png'),Path('train/3/10091.png')...]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's open one image for each label, to ensure that they are actuall images of 3 and 7.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im3_path</span> <span class="o">=</span> <span class="n">threes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">im3</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im3_path</span><span class="p">)</span>
<span class="n">im3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAA9ElEQVR4nM3Or0sDcRjH8c/pgrfBVBjCgibThiKIyTWbWF1bORhGwxARxH/AbtW0JoIGwzXRYhJhtuFY2q1ocLgbe3sGReTuuWbwkx6+r+/zQ/pncX6q+YOldSe6nG3dn8U/rTQ70L8FCGJUewvxl7NTmezNb8xIkvKugr1HSeMP6SrWOVkoTEuSyh0Gm2n3hQyObMnXnxkempRrvgD+gokzwxFAr7U7YXHZ8x4A/Dl7rbu6D2yl3etcw/F3nZgfRVI7rXM7hMUUqzzBec427x26rkmlkzEEa4nnRqnSOH2F0UUx0ePzlbuqMXAHgN6GY9if5xP8dmtHFfwjuQAAAABJRU5ErkJggg==%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im7_path</span> <span class="o">=</span> <span class="n">sevens</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">im7</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im7_path</span><span class="p">)</span>
<span class="n">im7</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAAb0lEQVR4nN2QwRWAIAxDv07GaHWyulk8qCjQ4t3ewn9JU+DHU8zlETA3SZICi+r0yM9nN5NKB28EQaokGUAZjdSKHtSpha+AhOVGBRufzfHvAJQJ+wq1SWja1IbQtVHb3sjl1aZRrTOtAoDnZ0RzAH/BWXZpNUGUAAAAAElFTkSuQmCC%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Images-are-numbers-?">
<a class="anchor" href="#Images-are-numbers-?" aria-hidden="true"><span class="octicon octicon-link"></span></a>Images are numbers ?<a class="anchor-link" href="#Images-are-numbers-?"> </a>
</h4>
<p>Before we go any further, i need to tell you that an image for a computer is just a bunch of numbers.</p>
<p>To be more precise, it is a composed of pixels. To simplify things (and this is the case for our dataset), we'll take an example of gray scale images (images containing only black, white, and shades of grey in between).
Every pixel makes a tiny bit of the image where the pixel takes a value (between 0 and 255) and that value tells to the computer how to display that particular pixel. Aseembled together they form the image.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay, let's turn our image into a <em>Numpy</em> array (which is just an array but wth <strong>super powers</strong>, and <em>Numpy</em> is just the most used python module for <em>Numerical computing</em>).</p>
<p>The thing between brackets is called <strong>slicing</strong>, and it's telling <em>Numpy</em> that we want to display the fourth row/column up to but not including the thenth one.</p>
<p>As we can see, an image is just a bunch of numbers.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array</span><span class="p">(</span><span class="n">im3</span><span class="p">)[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[  0,   0,   0,   0,   0,   0],
       [  0,   0,   0,   0,   0,  29],
       [  0,   0,   0,  48, 166, 224],
       [  0,  93, 244, 249, 253, 187],
       [  0, 107, 253, 253, 230,  48],
       [  0,   3,  20,  20,  15,   0]], dtype=uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll do the same thing, but instead of an array, we'll turn our image into a <em>PyTorch</em> <strong>tensor</strong>, which behaves much like a <em>Numpy</em> array but has the benefit to do our <em>operations</em> in the <strong>GPU</strong> (it's a lot, i mean a lot <strong>faster</strong>).</p>
<p>And the <em>dtype</em> in the end is the type of data in the tensor/array, which in this case is an unsigned 8 bit integer (0 to 255).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tensor</span><span class="p">(</span><span class="n">im3</span><span class="p">)[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[  0,   0,   0,   0,   0,   0],
        [  0,   0,   0,   0,   0,  29],
        [  0,   0,   0,  48, 166, 224],
        [  0,  93, 244, 249, 253, 187],
        [  0, 107, 253, 253, 230,  48],
        [  0,   3,  20,  20,  15,   0]], dtype=torch.uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To better visualize how a computer display an image, we'll turn our tensor containing the pixel values of our image into a <em>DataFrame</em> (it's an object provided by the <strong>Pandas</strong> module. For now, you just need to know that it's a table of values). With each value (pixel) in the table displayed with the corresponding color (0 for white, 255 for black, values in between for shades of grey).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im3_t</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">im3</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">im3_t</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">22</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">'font-size'</span><span class="p">:</span><span class="s1">'6pt'</span><span class="p">})</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">'Greys'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col5,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col7,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col9,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col11,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col12,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col14,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col7,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col9,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col5,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col7,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col9,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col5,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col7,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col9,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col14,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col5,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col14,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col14,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col16,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col17,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col0,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col5,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col17{
            font-size:  6pt;
            background-color:  #ffffff;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col5{
            font-size:  6pt;
            background-color:  #efefef;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col13{
            font-size:  6pt;
            background-color:  #7c7c7c;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col7{
            font-size:  6pt;
            background-color:  #4a4a4a;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col9,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col5,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col6,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col7,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col11,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col12,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col12,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col1,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col3,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col12,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col12,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col11,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col11,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col11,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col12,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col14,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col15,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col16{
            font-size:  6pt;
            background-color:  #000000;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col11{
            font-size:  6pt;
            background-color:  #606060;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col12{
            font-size:  6pt;
            background-color:  #4d4d4d;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col14{
            font-size:  6pt;
            background-color:  #bbbbbb;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col3{
            font-size:  6pt;
            background-color:  #e4e4e4;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col6{
            font-size:  6pt;
            background-color:  #6b6b6b;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col14,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col14{
            font-size:  6pt;
            background-color:  #171717;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col9,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col11{
            font-size:  6pt;
            background-color:  #4b4b4b;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col10{
            font-size:  6pt;
            background-color:  #010101;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col1{
            font-size:  6pt;
            background-color:  #272727;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col2{
            font-size:  6pt;
            background-color:  #0a0a0a;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col3{
            font-size:  6pt;
            background-color:  #050505;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col5{
            font-size:  6pt;
            background-color:  #333333;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col6{
            font-size:  6pt;
            background-color:  #e6e6e6;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col7,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col10{
            font-size:  6pt;
            background-color:  #fafafa;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col8{
            font-size:  6pt;
            background-color:  #fbfbfb;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col9{
            font-size:  6pt;
            background-color:  #fdfdfd;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col4{
            font-size:  6pt;
            background-color:  #1b1b1b;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col5{
            font-size:  6pt;
            background-color:  #e0e0e0;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col11{
            font-size:  6pt;
            background-color:  #4e4e4e;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col14{
            font-size:  6pt;
            background-color:  #767676;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col1{
            font-size:  6pt;
            background-color:  #fcfcfc;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col2,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col3{
            font-size:  6pt;
            background-color:  #f6f6f6;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col4,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col7{
            font-size:  6pt;
            background-color:  #f8f8f8;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col7{
            font-size:  6pt;
            background-color:  #e8e8e8;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col11{
            font-size:  6pt;
            background-color:  #222222;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col13,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col12{
            font-size:  6pt;
            background-color:  #090909;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col14{
            font-size:  6pt;
            background-color:  #d0d0d0;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col10,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col11,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col6{
            font-size:  6pt;
            background-color:  #060606;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col13{
            font-size:  6pt;
            background-color:  #979797;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col8{
            font-size:  6pt;
            background-color:  #b6b6b6;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col9{
            font-size:  6pt;
            background-color:  #252525;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col12{
            font-size:  6pt;
            background-color:  #999999;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col5{
            font-size:  6pt;
            background-color:  #f9f9f9;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col7{
            font-size:  6pt;
            background-color:  #101010;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col9,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col9{
            font-size:  6pt;
            background-color:  #020202;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col11{
            font-size:  6pt;
            background-color:  #545454;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col12{
            font-size:  6pt;
            background-color:  #f1f1f1;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col5{
            font-size:  6pt;
            background-color:  #f7f7f7;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col7{
            font-size:  6pt;
            background-color:  #030303;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col12{
            font-size:  6pt;
            background-color:  #181818;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col13{
            font-size:  6pt;
            background-color:  #303030;
            color:  #f1f1f1;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col14{
            font-size:  6pt;
            background-color:  #a9a9a9;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col15{
            font-size:  6pt;
            background-color:  #fefefe;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col8,#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col9{
            font-size:  6pt;
            background-color:  #bababa;
            color:  #000000;
        }#T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col10{
            font-size:  6pt;
            background-color:  #393939;
            color:  #f1f1f1;
        }</style>
<table id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002">
<thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">0</th>        <th class="col_heading level0 col1">1</th>        <th class="col_heading level0 col2">2</th>        <th class="col_heading level0 col3">3</th>        <th class="col_heading level0 col4">4</th>        <th class="col_heading level0 col5">5</th>        <th class="col_heading level0 col6">6</th>        <th class="col_heading level0 col7">7</th>        <th class="col_heading level0 col8">8</th>        <th class="col_heading level0 col9">9</th>        <th class="col_heading level0 col10">10</th>        <th class="col_heading level0 col11">11</th>        <th class="col_heading level0 col12">12</th>        <th class="col_heading level0 col13">13</th>        <th class="col_heading level0 col14">14</th>        <th class="col_heading level0 col15">15</th>        <th class="col_heading level0 col16">16</th>        <th class="col_heading level0 col17">17</th>    </tr>
</thead>
<tbody>
                <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row0" class="row_heading level0 row0">0</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col0" class="data row0 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col1" class="data row0 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col2" class="data row0 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col3" class="data row0 col3">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col4" class="data row0 col4">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col5" class="data row0 col5">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col6" class="data row0 col6">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col7" class="data row0 col7">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col8" class="data row0 col8">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col9" class="data row0 col9">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col10" class="data row0 col10">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col11" class="data row0 col11">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col12" class="data row0 col12">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col13" class="data row0 col13">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col14" class="data row0 col14">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col15" class="data row0 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col16" class="data row0 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row0_col17" class="data row0 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row1" class="row_heading level0 row1">1</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col0" class="data row1 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col1" class="data row1 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col2" class="data row1 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col3" class="data row1 col3">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col4" class="data row1 col4">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col5" class="data row1 col5">29</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col6" class="data row1 col6">150</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col7" class="data row1 col7">195</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col8" class="data row1 col8">254</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col9" class="data row1 col9">255</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col10" class="data row1 col10">254</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col11" class="data row1 col11">176</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col12" class="data row1 col12">193</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col13" class="data row1 col13">150</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col14" class="data row1 col14">96</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col15" class="data row1 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col16" class="data row1 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row1_col17" class="data row1 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row2" class="row_heading level0 row2">2</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col0" class="data row2 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col1" class="data row2 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col2" class="data row2 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col3" class="data row2 col3">48</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col4" class="data row2 col4">166</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col5" class="data row2 col5">224</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col6" class="data row2 col6">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col7" class="data row2 col7">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col8" class="data row2 col8">234</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col9" class="data row2 col9">196</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col10" class="data row2 col10">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col11" class="data row2 col11">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col12" class="data row2 col12">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col13" class="data row2 col13">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col14" class="data row2 col14">233</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col15" class="data row2 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col16" class="data row2 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row2_col17" class="data row2 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row3" class="row_heading level0 row3">3</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col0" class="data row3 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col1" class="data row3 col1">93</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col2" class="data row3 col2">244</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col3" class="data row3 col3">249</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col4" class="data row3 col4">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col5" class="data row3 col5">187</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col6" class="data row3 col6">46</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col7" class="data row3 col7">10</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col8" class="data row3 col8">8</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col9" class="data row3 col9">4</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col10" class="data row3 col10">10</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col11" class="data row3 col11">194</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col12" class="data row3 col12">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col13" class="data row3 col13">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col14" class="data row3 col14">233</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col15" class="data row3 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col16" class="data row3 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row3_col17" class="data row3 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row4" class="row_heading level0 row4">4</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col0" class="data row4 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col1" class="data row4 col1">107</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col2" class="data row4 col2">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col3" class="data row4 col3">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col4" class="data row4 col4">230</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col5" class="data row4 col5">48</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col6" class="data row4 col6">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col7" class="data row4 col7">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col8" class="data row4 col8">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col9" class="data row4 col9">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col10" class="data row4 col10">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col11" class="data row4 col11">192</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col12" class="data row4 col12">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col13" class="data row4 col13">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col14" class="data row4 col14">156</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col15" class="data row4 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col16" class="data row4 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row4_col17" class="data row4 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row5" class="row_heading level0 row5">5</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col0" class="data row5 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col1" class="data row5 col1">3</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col2" class="data row5 col2">20</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col3" class="data row5 col3">20</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col4" class="data row5 col4">15</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col5" class="data row5 col5">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col6" class="data row5 col6">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col7" class="data row5 col7">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col8" class="data row5 col8">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col9" class="data row5 col9">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col10" class="data row5 col10">43</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col11" class="data row5 col11">224</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col12" class="data row5 col12">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col13" class="data row5 col13">245</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col14" class="data row5 col14">74</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col15" class="data row5 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col16" class="data row5 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row5_col17" class="data row5 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row6" class="row_heading level0 row6">6</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col0" class="data row6 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col1" class="data row6 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col2" class="data row6 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col3" class="data row6 col3">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col4" class="data row6 col4">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col5" class="data row6 col5">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col6" class="data row6 col6">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col7" class="data row6 col7">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col8" class="data row6 col8">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col9" class="data row6 col9">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col10" class="data row6 col10">249</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col11" class="data row6 col11">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col12" class="data row6 col12">245</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col13" class="data row6 col13">126</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col14" class="data row6 col14">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col15" class="data row6 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col16" class="data row6 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row6_col17" class="data row6 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row7" class="row_heading level0 row7">7</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col0" class="data row7 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col1" class="data row7 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col2" class="data row7 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col3" class="data row7 col3">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col4" class="data row7 col4">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col5" class="data row7 col5">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col6" class="data row7 col6">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col7" class="data row7 col7">14</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col8" class="data row7 col8">101</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col9" class="data row7 col9">223</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col10" class="data row7 col10">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col11" class="data row7 col11">248</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col12" class="data row7 col12">124</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col13" class="data row7 col13">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col14" class="data row7 col14">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col15" class="data row7 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col16" class="data row7 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row7_col17" class="data row7 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row8" class="row_heading level0 row8">8</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col0" class="data row8 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col1" class="data row8 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col2" class="data row8 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col3" class="data row8 col3">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col4" class="data row8 col4">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col5" class="data row8 col5">11</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col6" class="data row8 col6">166</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col7" class="data row8 col7">239</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col8" class="data row8 col8">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col9" class="data row8 col9">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col10" class="data row8 col10">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col11" class="data row8 col11">187</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col12" class="data row8 col12">30</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col13" class="data row8 col13">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col14" class="data row8 col14">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col15" class="data row8 col15">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col16" class="data row8 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row8_col17" class="data row8 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row9" class="row_heading level0 row9">9</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col0" class="data row9 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col1" class="data row9 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col2" class="data row9 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col3" class="data row9 col3">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col4" class="data row9 col4">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col5" class="data row9 col5">16</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col6" class="data row9 col6">248</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col7" class="data row9 col7">250</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col8" class="data row9 col8">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col9" class="data row9 col9">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col10" class="data row9 col10">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col11" class="data row9 col11">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col12" class="data row9 col12">232</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col13" class="data row9 col13">213</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col14" class="data row9 col14">111</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col15" class="data row9 col15">2</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col16" class="data row9 col16">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row9_col17" class="data row9 col17">0</td>
            </tr>
            <tr>
                        <th id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002level0_row10" class="row_heading level0 row10">10</th>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col0" class="data row10 col0">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col1" class="data row10 col1">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col2" class="data row10 col2">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col3" class="data row10 col3">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col4" class="data row10 col4">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col5" class="data row10 col5">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col6" class="data row10 col6">0</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col7" class="data row10 col7">43</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col8" class="data row10 col8">98</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col9" class="data row10 col9">98</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col10" class="data row10 col10">208</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col11" class="data row10 col11">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col12" class="data row10 col12">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col13" class="data row10 col13">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col14" class="data row10 col14">253</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col15" class="data row10 col15">187</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col16" class="data row10 col16">22</td>
                        <td id="T_8dbbcc2c_1c19_11eb_8a7d_0242ac1c0002row10_col17" class="data row10 col17">0</td>
            </tr>
    </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's open all our images, turn them into tensors and put them in the corresponding list. To speed things up, we'll use a list comprehension (for more details a quick Google search will do it).</p>
<p>Let's ensure that we have all our images ready by checking the length of the two lists.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seven_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">sevens</span><span class="p">]</span>
<span class="n">three_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">threes</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(6131, 6265)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So far we have seen how to turn our images into tensors/arrays (a bunch of numbers), but how do we do the reverse operation ?</p>
<p>Well it is pretty simple, thanks to fastai <em>show_image</em> method, we can do just that.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remember we have to find the perfect 3 and 7, one way of doing it (our approach) is to find the mean of every pixel of all the 3/7 images of our dataset.</p>
<p>To do that we'll <strong>stack</strong> our second order tensors (second order means that it's a two dimensionnal object or matrix, more generally we say that we have a <strong>k-th order tensor</strong>) to form a third order tensor (three dimesionnal object).
And cast it to float (turn our integers in the tensor into float, in other words change the type of the data in our tensor).</p>
<p>We also divide by 255 because when images are represented by floats, we generally expect the values to be between 0 and 255.</p>
<p>To ensure that we've done this right we print the <strong>shape</strong> of the tensor (which is the number of elements in each axis/dimension) and we check that we have indeed 6131 images of 28x28.</p>
<blockquote>
<p>Note that nothing about this tensor tells us explicitly that the first axis is the number of images and so on. This is because it is entirely up to us and how we construct the it. For the tensor it is just a bunch of numbers in memory.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked_sevens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([6131, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also check that we did not screw something, by checking the number of dimensions/axis of the tensor (which in this case is three).</p>
<blockquote>
<p>The number of dimmesions/axis of the tensor is also the length of the shape.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked_threes</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay, now we have everything we need, to calculate our perfect 3/7 we'll use the <em>mean</em> method provided by <em>PyTorch</em> and we give it as an argument the index along which we want to calculate the mean, in our case it'll be the first axis (0-indexed) because we want the mean of every pixel across all images.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean3</span> <span class="o">=</span> <span class="n">stacked_threes</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">mean3</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean7</span> <span class="o">=</span> <span class="n">stacked_sevens</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">mean7</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>As you can notice, the parts where images "agree" (similar pixel values) that this is how a handwritten 3/7 is supposed to look like are darker then the parts where they disagree-- kinda of blurry (due to different pixel values).</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Measure-the-distance-(similarity)">
<a class="anchor" href="#2.-Measure-the-distance-(similarity)" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Measure the distance (similarity)<a class="anchor-link" href="#2.-Measure-the-distance-(similarity)"> </a>
</h3>
<p>Our final step will consist of calculating the distance of a given image and our perfect 3/7 and we'll say that it is a 3/7 if it is closest to the perfect 3/7 respectively.</p>
<p>Okay, but what's the distance between two images. For that purpose we can use either :</p>
<ul>
<li>
<p><strong>L1 norm</strong>: which is the mean absolute difference, in other words, we take the absolute value of the difference between each pixel of the two images and average over all pixels.</p>
</li>
<li>
<p><strong>L2 norm</strong>: root mean squared error, same as above but instead of taking the absolute value, we square the differences, then average and finally take the square root (which will "undo" the squaring).</p>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_3</span> <span class="o">=</span> <span class="n">stacked_threes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">dist_3_abs</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean3</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dist_3_sqr</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="n">dist_3_abs</span><span class="p">,</span> <span class="n">dist_3_sqr</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.1114), tensor(0.2021))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dist_7_abs</span> <span class="o">=</span> <span class="p">(</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean7</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dist_7_sqr</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_3</span> <span class="o">-</span> <span class="n">mean7</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="n">dist_7_abs</span><span class="p">,</span> <span class="n">dist_7_sqr</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.1586), tensor(0.3021))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Taking a random 3, we see that the distance from the perfect 3 is less then the distance from the perfect 7, which is exactly what we wanted. Our solution looks promising !</p>
<blockquote>
<p><em>PyTorch</em> provides methods to calculate <strong>L1 norm &amp; MSE</strong> (<strong>MSE</strong> is the just L2 norm whitout the square root), they are inside the <em>torch.nn.functional</em>, which is already imported by fastai as <strong>F</strong>.</p>
<p>L1 &amp; L2 norm are <strong>loss functions</strong>.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">l1_loss</span><span class="p">(</span><span class="n">a_3</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span><span class="n">mean7</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span><span class="n">mean7</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.1586), tensor(0.3021))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>The <strong>MSE</strong> penalyzes mistakes more heavily then <strong>L1 norm</strong> (on the other hand it is more merciful towards small mistakes).</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To test how good our model is, we'll need a validation set (images he has not seen before), recall that in our dataset folder this is already provided by <strong>MNIST</strong> in the valid folder. So we'll just do the same operations we did for the training set seen above to create our <em>tensors</em>.</p>
<blockquote>
<p>It's good practise to check your tensor's shape to ensure that you've done everything properly.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'valid'</span><span class="o">/</span><span class="s1">'3'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">valid_3_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'valid'</span><span class="o">/</span><span class="s1">'7'</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">valid_7_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_3_tens</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">valid_7_tens</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([1010, 28, 28]), torch.Size([1028, 28, 28]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's create a function that does what we've discussed earlier (calculate distances), the <em>(-1, -2)</em> means that we calculate the mean along the last axis and the second last axis (which represents the width and the height of the image).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mnist_distance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="n">mnist_distance</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span> <span class="n">mean3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.1114)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cool this was for one image tho but how about all the validation set (because this is what we need to calulate the <em>metric</em>). Well i'am glad you ask, this shows that you are paying attention (or just that i'am talking to myself ...).</p>
<p>Well thanks to <em>PyTorch</em> we don't have to re-write <em>mnist_distance</em> function because it uses a neat trick called <strong>Broadcasting</strong>. It means that rather then complaining about the shapes being different, when given a rank 3 tensor (validation set images) and rank 2 tensor (ideal 3), it treats the rank 2 tensor as if it was a rank 3 one (you can imagine in your head that it kinda of duplicates the ideal 3 1010 times and it substracts it from each image from the validation set element wise, but it does not actually duplicate it-- no more memory is allocated).</p>
<p>Finally it takes the mean over the last and second last axis, which is the height and width of each image, which leaves us with rank 1 tensor (array), of the distance of each image in the validation set from the ideal 3.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_3_dist</span> <span class="o">=</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">,</span> <span class="n">mean3</span><span class="p">)</span>
<span class="n">valid_3_dist</span><span class="p">,</span> <span class="n">valid_3_dist</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([0.1133, 0.1656, 0.1848,  ..., 0.1623, 0.1447, 0.1252]),
 torch.Size([1010]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now all is left to do is create a function that tells us whether an image is a 3 or a 7. By comparing the distance between the ideal 3/7 respectively (True for 3, False for 7).</p>
<blockquote>
<p>This function will automaticlly do <strong>Broadcasting</strong> and be applied <strong>element wise</strong>, just like all <em>PyTorch</em> functions and operators.</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mnist_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_3</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ True,  True,  True,  ...,  True, False,  True])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>If we convert a boolean tensor into float we get a 1. for True and 0. for False (this will come in handy to calculate the accuracy).</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_3</span><span class="p">(</span><span class="n">a_3</span><span class="p">),</span> <span class="n">is_3</span><span class="p">(</span><span class="n">a_3</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(True), tensor(1.))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see how good our simple solution is. It has <strong>95%</strong> overall accuracy which is more then acceptable !</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">accuracy_3s</span> <span class="o">=</span>      <span class="n">is_3</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">accuracy_7s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">is_3</span><span class="p">(</span><span class="n">valid_7_tens</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">accuracy_3s</span><span class="p">,</span><span class="n">accuracy_7s</span><span class="p">,(</span><span class="n">accuracy_3s</span><span class="o">+</span><span class="n">accuracy_7s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(0.9168), tensor(0.9854), tensor(0.9511))</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/blog/2020/11/01/start-simple-start-with-a-baseline.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Graduate student in computer science, blog about my learning journey (AI/ Deep learning/ Machine learning/ Computer vision).</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/igrek-code" title="igrek-code"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
